<scroll-view scroll-y style="height:{{height-53*2}}rpx;">
  <view class='regular bgc padding'>
    <view class='trans-shop' wx:if='{{isReturn}}'>
      <view class='trans-shop-lable regular'>{{salesReturn}}</view>
    </view>
    <view wx:else>
      <view class='center'>
        <image class='trans-shop-img' src="{{addressStore}}"></image>
        <view class='trans-shop-lable regular'>{{profileName}}</view>
        <view class='trans-shop-value'>{{phone}}</view>
      </view>
      <view class='trans-number-time'>
        <view>
          <view class="gray-chars">{{address}}</view>
          <view class="gray-chars">{{storeName}}</view>
        </view>

      </view>
    </view>
  </view>
  <view class='color-bg bgc'></view>
  <view class='bgc goods-container'>
    <view class='scroll-container' scroll-top="{{scrollTop}}">
      <view>
        <view style='height: {{ expandAll?"auto":(heightGoods+"rpx")}}; overflow:{{expandAll?"auto":"hidden"}};'>
          <view class='item-container' style='margin-top:10rpx' wx:for="{{data}}" wx:key='{{groupIndex}}' wx:for-item="orderGroup" itemId='{{orderGroup.groupId}}' locationId='{{item.locationId}}'>
            <view style='display:flex; justify-content: space-between; background-color: white; margin-top: 0rpx; align-items:center;' wx:if="{{orderGroup.combinationFlag}}">
              <view style=''>
                <view class='suite-1' style='height:34rpx;'>套装</view>
                <view class='dollar suite-2' style='height:34rpx;'>{{orderGroup.suitePrice}}</view>
              </view>
              <view class='suite-3'>x{{orderGroup.count}}</view>
            </view>
            
            <block wx:for="{{orderGroup.items}}" wx:key='{{itemIndex}}' itemId='{{item.itemId}}'>
              <view class='item-container-fg'>
                <view class='order-content'>
                  <view class='center' style='width:100%;'>
                    <image src='{{item.itemImageAddress1?item.itemImageAddress1:defImg}}' style="width: 180rpx;height: 180rpx;border-radius: 8rpx;margin-right:14rpx;background:#fff;" mode='aspectFit'></image>
                    <view class='column' style="justify-content: space-between; align-items:left; width:100%;">
                      <view class='darker-gray-chars item-name regular' style='width:auto;'>{{item.itemName}}</view>
                      <text class='regular item-standard'>规格：{{item.itemSpecification}}</text>
                      <view class='darker-gray-chars center' style="justify-content:space-between; width:100%;">
                        <text class='confirm-price'>￥{{item.price}}</text>
                        <text>x{{item.quantity}}</text>
                      </view>
                    </view>
                  </view>
                </view>
              </view>
            </block>

            <view class='item-container-fg'  wx:if='{{orderGroup.cartCombinationPromotions && orderGroup.cartCombinationPromotions.length>0 && orderGroup.cartCombinationPromotions[0].giftItems && orderGroup.cartCombinationPromotions[0].giftItems.length>0}}'>
              <view wx:for="{{orderGroup.cartCombinationPromotions[0].giftItems}}" wx:key='{{giftIndex}}' wx:for-item="gift">
                <view class='order-content'>
                  <view class='center' style='width:100%;'>
                    
                    <image src='{{gift.itemImageAddress1?gift.itemImageAddress1:defImg}}' style="width: 180rpx;height: 180rpx;border-radius: 8rpx;margin-right:14rpx;background:#fff;" mode='aspectFit'></image>
                    <view class='column' style="justify-content: space-between; align-items:left; width:100%;">
                      <view class='darker-gray-chars item-name regular' style='width:auto; display: flex;'><view  class='free-gift' style='font-size: 24rpx;' >赠品</view>{{gift.giftItemName}}</view>
                      <text class='regular item-standard'>规格：{{gift.itemUnit}}</text>
                      <view class='darker-gray-chars center' style="justify-content:space-between; width:100%;">
                        <text class='confirm-price'>￥0</text>
                        <text>x{{gift.quantity}}</text>
                      </view>
                    </view>
                  </view>
                </view>
              </view>
            </view>


          </view>
        </view>

        <view wx:if='{{totalItemNumber>2}}' catch:tap='toggleGoods' class='regular center' style='font-size: 24rpx;color: #999999;padding:20rpx 0; align-items:center;justify-content:center;'>
          {{expandAll?'收起全部商品信息':'展开全部商品信息'}}
          <image src="{{expandAll?'img/up.png':'img/down.png'}}" style='width:32rpx;height:32rpx;'></image>
        </view>
      </view>
    </view>
  </view>
  <view>
    <view class='padding mgt bgc center order-item-container'>
      <text class='regular order-field '>支付方式</text>
      <text class='medium order-val'>货到付款</text>
    </view>
    <view class='padding mgt bgc center order-item-container'>
      <text class='regular order-field '>配送方式</text>
      <text class='medium'>上门配送</text>
    </view>
    <!-- <view class='padding mgt bgc center order-item-container'>
    <text class='regular order-field '>买家留言：</text>
    <textarea class='textarea' placeholder="选填" value='{{textarea}}' bindblur='textareaConfirm' auto-height='{{true}}' />
  </view> -->
    <view class='padding mgt bgc center order-item-container' style="margin-top: 15rpx;">
      <!-- <text class='regular order-field '>促销折扣</text> -->
      <!-- <text class='medium'>满减活动；满送活动</text> -->
    </view>
    <view class='padding mgt bgc center order-item-container' style='align-items:center;'>
      <text class='regular order-field '>积分抵扣</text>
      <text wx:if='{{points}}' class='medium' style='width:60%;'>共有{{pointBalance}}积分，本单可用{{points}}积分，抵￥{{maxDeduction}}</text>
      <text wx:else>共有{{pointBalance}}积分，未达到20000积分不可用</text>
      <view>
        <checkbox-ios id='checkbox-ios' bindchangechecked="onChangeChecked" enable-tap='{{pointBalance}}'>
          <!-- 这部分内容将被放置在组件 <slot> 的位置上 -->
          <!-- <view>这里是插入到组件slot中的内容</view> -->
        </checkbox-ios>
      </view>
    </view>
    <view wx-if='{{isVisible}}' class='padding mgt center order-item-container' style='align-items: center;background: #F7F8FA;justify-content:flex-start;'>
      <text class='regular order-field '>使用积分</text>
      <view style="margin-left: 30rpx;">
        <input type="number" value='{{usedPoints}}' class='input' bindinput='bindinput' />
      </view>
      <text class='medium' style="color: #EE711F;margin-left: 15rpx;">抵扣￥{{credit}}</text>
    </view>
    <view class='padding bgc' style="margin-top: 15rpx;">
      <view class='  center order-item-container'>
        <text class='regular order-field '>商品金额</text>
        <text class='medium dollar'>{{totalBeforePromotion}}</text>
      </view>
      <view class='  center order-item-container' wx:if="{{discountTotalAmount!==0 && discountTotalAmount!=='0'}}">
        <text class='regular order-field '>促销折扣</text>
        <text class='medium dollar-minus' >{{discountTotalAmount}}</text>
      </view>
      <view wx:if='{{isVisible && credit}}' class='  center order-item-container'>
        <text class='regular order-field '>积分折扣</text>
        <text class='medium dollar-minus' style='color: rgb(236,103,32);'>{{credit}}</text>
      </view>
      <view class='center order-item-container'>
        <text class='regular order-field '>应付金额</text>
        <text class='medium dollar'>{{actual}}</text>
      </view>
    </view>

  </view>
</scroll-view>
<view class='padding mgt bgc center order-item-container confirm-view' style='top:{{height}}rpx;'>
  <text class='medium order-field dollar' style='color:#EE711F;font-size: 44rpx;'>{{actual}}</text>
  <button class='medium submit regular' catch:tap='createOrder'>提交订单</button>
</view>
<block wx:if="{{isFailed}}">
  <view class='popup-container grey-overlay'></view>
  <view class=' center-center popup-container'>
    <view class='confirm-popup column bgc regular'>
      <image src='./img/bg_fail.png'></image>
      <text>{{prompt}}</text>
      <button class='center-center' catch:tap='closePopup'>我知道了</button>
    </view>
  </view>
</block>